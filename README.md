# ğŸ“¦ ë¬´ë¹™ (Moving) - Backend

ì´ì‚¬ ì „ë¬¸ê°€ ë§¤ì¹­ ì„œë¹„ìŠ¤ ë¬´ë¹™ì˜ ë°±ì—”ë“œ API ì„œë²„ì…ë‹ˆë‹¤. NestJS í”„ë ˆì„ì›Œí¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œë˜ì—ˆìœ¼ë©°, ê³ ê°ê³¼ ì´ì‚¬ ê¸°ì‚¬ë¥¼ ì—°ê²°í•˜ëŠ” í”Œë«í¼ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ ê°œìš”

ë¬´ë¹™ì€ ì´ì‚¬ ì„œë¹„ìŠ¤ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” ê³ ê°ê³¼ ì´ì‚¬ ì „ë¬¸ê°€ ê¸°ì‚¬ë‹˜ì„ ë§¤ì¹­í•˜ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ê³ ê°ì€ ê²¬ì ì„ ìš”ì²­í•˜ê³ , ê¸°ì‚¬ëŠ” ê²¬ì ì„ ì œì•ˆí•˜ë©°, ìƒí˜¸ í‰ê°€ë¥¼ í†µí•´ ì‹ ë¢°ì„± ìˆëŠ” ì´ì‚¬ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ ê¸°ê°„

2025.5.15 ~ 2025.06.27

## ë§í¬

- [ë¬´ë¹™ ì„œë¹„ìŠ¤ ë°”ë¡œê°€ê¸°](https://5-moving.vercel.app/)
- [API ë¬¸ì„œ ë°”ë¡œê°€ê¸°](https://hay-oon.com/api-docs)
- [íŒ€ ë…¸ì…˜ ë°”ë¡œê°€ê¸°](https://positive-kingfisher-003.notion.site/1-_-1f0d9fa672ba8055b067ec2833354efd?source=copy_link)

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)

### âœ… ë°±ì—”ë“œ (Backend)
![NestJS](https://img.shields.io/badge/NestJS-E0234E?style=flat-square&logo=nestjs&logoColor=white)
![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?style=flat-square&logo=typescript&logoColor=white)
![Node.js](https://img.shields.io/badge/Node.js-339933?style=flat-square&logo=nodedotjs&logoColor=white)

### ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ (Database)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-4169E1?style=flat-square&logo=postgresql&logoColor=white)
![TypeORM](https://img.shields.io/badge/TypeORM-FF6C37?style=flat-square&logoColor=white)

### ğŸ” ì¸ì¦ ë° ìŠ¤í† ë¦¬ì§€ (Authentication & File Storage)
![JWT](https://img.shields.io/badge/JWT-black?style=flat-square&logo=jsonwebtokens)
![Passport](https://img.shields.io/badge/Passport-34E27A?style=flat-square)
![Google](https://img.shields.io/badge/GoogleOAuth-4285F4?style=flat-square&logo=google&logoColor=white)
![Kakao](https://img.shields.io/badge/KakaoOAuth-FFCD00?style=flat-square&logo=kakaotalk&logoColor=black)
![Naver](https://img.shields.io/badge/NaverOAuth-03C75A?style=flat-square&logo=naver&logoColor=white)
![AWS S3](https://img.shields.io/badge/AWS%20S3-569A31?style=flat-square&logo=amazonaws&logoColor=white)

### ğŸ§ª í…ŒìŠ¤íŠ¸ (Testing)
![Jest](https://img.shields.io/badge/Jest-C21325?style=flat-square&logo=jest&logoColor=white)

### âš™ï¸ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € (Package Manager)
![pnpm](https://img.shields.io/badge/pnpm-F69220?style=flat-square&logo=pnpm&logoColor=white)

### ğŸ§¾ ê²€ì¦ ë° API ë¬¸ì„œí™” (Validation & API Docs)
![Zod](https://img.shields.io/badge/Zod-3c9d9b?style=flat-square&logoColor=white)
![Swagger](https://img.shields.io/badge/Swagger-85EA2D?style=flat-square&logo=swagger&logoColor=black)

### ğŸš€ ë°°í¬ (Deployment)
![Render](https://img.shields.io/badge/Render-46E3B7?style=flat-square&logo=render&logoColor=white)

---

## ğŸ“¦ ì „ì²´ ê¸°ìˆ  ê°œìš” (Full Stack Overview)

- **í”„ë ˆì„ì›Œí¬ (Framework)**: NestJS  
- **ì–¸ì–´ (Language)**: TypeScript  
- **ë°ì´í„°ë² ì´ìŠ¤ (Database)**: PostgreSQL + TypeORM  
- **ì¸ì¦ (Authentication)**: JWT, Passport (Local, Google, Kakao, Naver)  
- **íŒŒì¼ ìŠ¤í† ë¦¬ì§€ (File Storage)**: AWS S3  
- **íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € (Package Manager)**: pnpm  
- **í…ŒìŠ¤íŠ¸ (Testing)**: Jest  

### ğŸ§° ê°œë°œ ë„êµ¬ (Development Tools)

- **ESLint**: ì½”ë“œ í’ˆì§ˆ ê´€ë¦¬ (Code Quality Enforcement)  
- **Prettier**: ì½”ë“œ í¬ë§·íŒ… (Code Formatting)  
- **TypeScript**: íƒ€ì… ì•ˆì •ì„± í™•ë³´ (Static Typing for Safety)

### ğŸ“‘ API ë° ê²€ì¦ (API & Validation)

- **Zod**: ëŸ°íƒ€ì„ ìŠ¤í‚¤ë§ˆ ê²€ì¦ (Runtime Schema Validation)  
- **Swagger**: ìë™ API ë¬¸ì„œ ìƒì„± (Auto-generated API Docs)

### ğŸ”” ê¸°íƒ€ ê¸°ëŠ¥ (Other Features)

- **Server-Sent Events (SSE)** ê¸°ë°˜ì˜ ì•Œë¦¼ ì‹œìŠ¤í…œ


## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
src/
â”œâ”€â”€ auth/                 # ì¸ì¦ ë° ì¸ê°€
â”œâ”€â”€ user/                # ì‚¬ìš©ì ê³µí†µ ê¸°ëŠ¥
â”œâ”€â”€ customer-profile/    # ê³ ê° í”„ë¡œí•„ ê´€ë¦¬
â”œâ”€â”€ mover-profile/       # ê¸°ì‚¬ í”„ë¡œí•„ ê´€ë¦¬
â”œâ”€â”€ estimate-request/    # ê²¬ì  ìš”ì²­ ê´€ë¦¬
â”œâ”€â”€ estimate-offer/      # ê²¬ì  ì œì•ˆ ê´€ë¦¬
â”œâ”€â”€ like/               # ì°œ ê¸°ëŠ¥
â”œâ”€â”€ review/             # ë¦¬ë·° ì‹œìŠ¤í…œ
â”œâ”€â”€ notification/       # ì•Œë¦¼ ì‹œìŠ¤í…œ
â”œâ”€â”€ s3/                 # íŒŒì¼ ì—…ë¡œë“œ
â”œâ”€â”€ database/           # ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
â”œâ”€â”€ scheduler/          # ìŠ¤ì¼€ì¤„ëŸ¬
â””â”€â”€ common/             # ê³µí†µ ìœ í‹¸ë¦¬í‹°
```

## ë°ì´í„°ë² ì´ìŠ¤ ERD

![Database ERD](./docs/moving-erd.svg)

## ì•„í‚¤í…ì³

![Architecture](./docs/moving-architecture_final.png)

## íŒ€ì›ë³„ ë‹´ë‹¹ ê¸°ëŠ¥

### [ì •í•˜ìœ¤](https://github.com/hay-oon)

**DB ì„¤ê³„ & ê¸°ì‚¬ë‹˜ ê²¬ì  ê´€ë¦¬ ê´€ë ¨ CRUD ë‹´ë‹¹**

- ë°ì´í„° ëª¨ë¸ë§ ë° API ëª…ì„¸ ì‘ì„±
- `POST /api/s3/presigned-url` - S3 Presigned URL ìš”ì²­
- `GET /api/estimate-offer/:offers` - ê²¬ì  ì œì•ˆ ëª©ë¡ ì¡°íšŒ
- `GET /api/estimate-offer/:offerId` - ê²¬ì  ì œì•ˆ ìƒì„¸ ì¡°íšŒ
- `GET /api/estimate-offer/rejected-offers` - ë°˜ë ¤í•œ ê²¬ì  ëª©ë¡ ì¡°íšŒ
- `POST /api/estimate-offer/:requestId` - ê²¬ì  ë³´ë‚´ê¸°
- `PATCH /api/estimate-offer/:requestId/rejected` - ê²¬ì  ë°˜ë ¤í•˜ê¸°
- AWS ë°°í¬ ì•„í‚¤í…ì³ êµ¬í˜„ ë° Github Actions CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

### [ìµœì€ë¹„](https://github.com/silverraining)

**DB ì„¤ê³„ & ì¸ì¦, ê³ ê° ê²¬ì  ìš”ì²­ ë° ê²¬ì  ìˆ˜ì‹  íë¦„ ì „ë°˜ CRUD ë‹´ë‹¹**

- ì‚¬ìš©ì ì¸ì¦ ê´€ë ¨ API êµ¬í˜„
  - `POST /api/auth/register` â€“ ë¡œì»¬ íšŒì›ê°€ì…
  - `POST /api/auth/login` â€“ ë¡œê·¸ì¸
  - `POST /api/auth/token/access` â€“ ì•¡ì„¸ìŠ¤ í† í° ì¬ë°œê¸‰
  - `POST /api/auth/logout` â€“ ë¡œê·¸ì•„ì›ƒ
  - `PATCH /api/auth/me` â€“ íšŒì› ì •ë³´ ìˆ˜ì •
  - `GET /api/auth/login/:social?state=${role}` â€“ ì†Œì…œ íšŒì›ê°€ì… (Google, Kakao)

- ê³ ê° ê²¬ì  ìš”ì²­ ê´€ë ¨ API
  - `POST /api/estimate-request` â€“ ê²¬ì  ìš”ì²­ ìƒì„± (ê³ ê°)
  - `GET /api/estimate-request/history` â€“ ê³¼ê±° ê²¬ì  ìš”ì²­ê³¼ ë°›ì•˜ë˜ ê²¬ì  ëª©ë¡ ì¡°íšŒ 
  - `PATCH /api/estimate-request/:requestId/targeted` â€“ ì§€ì • ê¸°ì‚¬ ê²¬ì  ìš”ì²­
  - `PATCH /api/estimate-request/:requestId/cancel` â€“ ê²¬ì  ìš”ì²­ ì·¨ì†Œ 
  - `PATCH /api/estimate-request/:requestId/complete` â€“ ì´ì‚¬ ì™„ë£Œ ì²˜ë¦¬ 

- ê³ ê°ì˜ ê²¬ì  ìˆ˜ì‹  ë° ì¡°íšŒ API
  - `GET /api/estimate-offer/:requestId/pending` â€“ ê³ ê°ì´ ë°›ì€ ê²¬ì  ì œì•ˆ ëª©ë¡ ì¡°íšŒ 
  - `GET /api/estimate-offer/:requestId/:moverId/pending` â€“ ê³ ê°ì´ íŠ¹ì • ê¸°ì‚¬ì˜ ê²¬ì  ì œì•ˆ ìƒì„¸ ì¡°íšŒ

- ê¸°ì‚¬ ê¸°ì¤€ ê³ ê°ì´ ìƒì„±í•œ ê²¬ì  ìš”ì²­ ìˆ˜ì‹  API
  - `GET /api/estimate-request` â€“ ê¸°ì‚¬ê°€ ë°›ì€ ê²¬ì  ìš”ì²­ ëª©ë¡ ì¡°íšŒ


### [ë¯¼ì§€ì˜](https://github.com/Obsessive-Curiosity)

**DB ì„¤ê³„ & ê³ ê° ë° ê¸°ì‚¬ í”„ë¡œí•„ ê´€ë¦¬, ì°œí•˜ê¸°, ë¦¬ë·° ê´€ë ¨ CRUD ë‹´ë‹¹**

- ì¸ì¦ ê´€ë ¨ API 
  - `POST /api/auth/register` â€“ ë¡œì»¬ íšŒì›ê°€ì…  
  - `POST /api/auth/login` â€“ ë¡œê·¸ì¸  
  - `POST /api/auth/token/access` â€“ ì•¡ì„¸ìŠ¤í† í° ì¬ë°œê¸‰
  - `GET /api/auth/login/:social?state=${role}` â€“ ì†Œì…œ íšŒì›ê°€ì… (Naver)
  
- ê³ ê° í”„ë¡œí•„ ê´€ë ¨ API
  - `POST /api/customer` â€“ ê³ ê° í”„ë¡œí•„ ë“±ë¡
  - `GET /api/customer/me` â€“ ê³ ê° ë³¸ì¸ í”„ë¡œí•„ ì¡°íšŒ
  - `PATCH /api/customer/me` â€“ ê³ ê° ë³¸ì¸ í”„ë¡œí•„ ìˆ˜ì •

- ê¸°ì‚¬ í”„ë¡œí•„ ê´€ë ¨ API
  - `POST /api/mover` â€“ ê¸°ì‚¬ í”„ë¡œí•„ ë“±ë¡
  - `GET /api/mover/:id` â€“ ê¸°ì‚¬ ìƒì„¸ í˜ì´ì§€ ì¡°íšŒ
  - `POST /api/mover/search` â€“ ê¸°ì‚¬ ëª©ë¡ ì¡°íšŒ
  - `GET /api/mover/me` â€“ ê¸°ì‚¬ ë³¸ì¸ í”„ë¡œí•„ ì¡°íšŒ
  - `PATCH /api/mover/me` â€“ ê¸°ì‚¬ ë³¸ì¸ í”„ë¡œí•„ ìˆ˜ì •
 
- ê¸°ì‚¬ ì°œí•˜ê¸° ê¸°ëŠ¥ 
  - `POST /api/like` â€“ ê¸°ì‚¬ ì°œí•˜ê¸°  
  - `DELETE /api/like/:moverId` â€“ ê¸°ì‚¬ ì°œí•˜ê¸° ì·¨ì†Œ  
  - `GET /api/like/mover` â€“ ì°œí•œ ê¸°ì‚¬ ëª©ë¡ ì¡°íšŒ  

- ë¦¬ë·° ê´€ë ¨ API 
  - `POST /api/review/:reviewableOfferId` â€“ ë¦¬ë·° ì‘ì„±  
  - `GET /api/review/available` â€“ ë¦¬ë·° ì‘ì„± ê°€ëŠ¥í•œ ê²¬ì  ì¡°íšŒ  
  - `GET /api/review/customer/me` â€“ ê³ ê°(ì‘ì„±í•œ) ë¦¬ë·° ì¡°íšŒ  
  - `GET /api/review/mover/me` â€“ ê¸°ì‚¬(ë°›ì€) ë¦¬ë·° ì¡°íšŒ  
  - `GET /api/review/mover/:id` â€“ í•´ë‹¹ ê¸°ì‚¬(ë°›ì€) ë¦¬ë·° ì¡°íšŒ  

- ê²¬ì  ì œì•ˆ í™•ì¸ ë° í™•ì • API
  - `PATCH /api/estimate-offer/:offerId/confirmed` â€“ ê¸°ì‚¬ì˜ ì œì•ˆ ê²¬ì  í™•ì • (ê³ ê°)

### [ê¹€ì¡°ìˆœ](https://github.com/josunkim)

**ì•Œë¦¼ ê´€ë ¨ CRUD ë‹´ë‹¹**

- `POST /api/notifications` - ì•Œë¦¼ ìƒì„± (ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ/Cronì„ ì‚¬ìš©í•˜ì—¬ ì¼ì • ì´ë²¤íŠ¸ ë° ì‹œê°„ì´ ë˜ë©´ ì•Œë¦¼ ìë™ìƒì„± )
- `GET /api/notifications` - ìœ ì €ì˜ ì•Œë¦¼ ì¤‘ ì½ì§€ì•Šì€ ì•Œë¦¼ì„ ì „ì²´ ì¡°íšŒ
- `PATCH /api/notifications/read` - ì•Œë¦¼ ì½ìŒì²˜ë¦¬
- `GET /api/notifications/stream` - ì•Œë¦¼ SSEì—°ê²° (ì‹ ê·œ ì•Œë¦¼ì´ ìƒì„±ë˜ë©´ Clientì— ì „ì†¡)


## ì£¼ìš” ê¸°ëŠ¥

### ì¸ì¦ ì‹œìŠ¤í…œ

- JWT ê¸°ë°˜ ì¸ì¦
- ì†Œì…œ ë¡œê·¸ì¸ (Google, Kakao, Naver)
- ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (ê³ ê°/ê¸°ì‚¬)

### ê²¬ì  ì‹œìŠ¤í…œ

- ê³ ê°ì˜ ê²¬ì  ìš”ì²­
- ê¸°ì‚¬ì˜ ê²¬ì  ì œì•ˆ
- ê²¬ì  ìƒíƒœ ê´€ë¦¬ (ëŒ€ê¸°/í™•ì •/ê±°ì ˆ)

### í”„ë¡œí•„ ê´€ë¦¬

- ê³ ê°/ê¸°ì‚¬ í”„ë¡œí•„ ë“±ë¡ ë° ìˆ˜ì •
- ê¸°ì‚¬ ê²€ìƒ‰ ë° í•„í„°ë§
- í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ

### í‰ê°€ ì‹œìŠ¤í…œ

- ì„œë¹„ìŠ¤ ì™„ë£Œ í›„ ìƒí˜¸ ë¦¬ë·°
- ë³„ì  ë° í…ìŠ¤íŠ¸ ë¦¬ë·°
- ê¸°ì‚¬ í‰ì  ê´€ë¦¬

### ë¶€ê°€ ê¸°ëŠ¥

- ê¸°ì‚¬ ì°œí•˜ê¸°
- ì‹¤ì‹œê°„ ì•Œë¦¼
- íŒŒì¼ ì—…ë¡œë“œ (AWS S3)
